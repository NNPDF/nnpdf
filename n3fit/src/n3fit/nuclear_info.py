"""
This module is a really dirty way to propagate the A-dependence into
the fit. By A-dependence one means the atomic number of the nucleus
involved in the fitting. There are two main reasons why this is done
in the current way:

    1. The information on the target(s) are not stored in the current
    FK tables. Ideally, one should have all the information concerning
    what are being collided as metadata in the tables. Currently, this
    is not the case, but this will change with the advent of `pineko`.

    2. There are still ongoing works happening towards (a) stripping
    off the C++ dependence of the code, and (b) modifying various parts
    of the codes to accommodate for the new `pineko` pipeline. In this
    sense, it is not worth spending huge amount of time implementing
    something that will be changed later.

This module will become completely obsolete once the new pipeline is
in place and working.
"""


class ErrorNuclearInfo(Exception):
    """Handle error regarding adding nuclear info."""

    pass


NDATA_SPECS = {
    "NMC96_Al_C": [{"A": 27, "Z": 13}, {"A": 12, "Z": 6}],
    "NMC95RE_Ca_D": [{"A": 40, "Z": 20}, {"A": 2, "Z": 1}],
    "NMC96_Be_C": [{"A": 9, "Z": 4}, {"A": 12, "Z": 6}],
    "NMC96_Ca_C": [{"A": 40, "Z": 20}, {"A": 12, "Z": 6}],
    "NMC95RE_Ca_Li": [{"A": 40, "Z": 20}, {"A": 6, "Z": 3}],
    "NMC95RE_C_Li": [{"A": 12, "Z": 6}, {"A": 2, "Z": 1}],
    "NMC95_C_D": [{"A": 12, "Z": 6}, {"A": 2, "Z": 1}],
    "NMC96_Fe_C": [{"A": 56, "Z": 26}, {"A": 12, "Z": 6}],
    "NMC96_Pb_C": [{"A": 208, "Z": 82}, {"A": 12, "Z": 6}],
    "NMC96_Sn_C": [{"A": 119, "Z": 50}, {"A": 12, "Z": 6}],
    "NMC95_Li_D": [{"A": 6, "Z": 3}, {"A": 2, "Z": 1}],
    "NMC95RE_He_D": [{"A": 4, "Z": 2}, {"A": 2, "Z": 1}],
    "NMC_p_D": [{"A": 1, "Z": 1}, {"A": 2, "Z": 1}],
    "SLACE139_Ag_D": [{"A": 108, "Z": 47}, {"A": 2, "Z": 1}],
    "SLACE139_Al_D": [{"A": 27, "Z": 13}, {"A": 2, "Z": 1}],
    "SLACE139_Au_D": [{"A": 197, "Z": 79}, {"A": 2, "Z": 1}],
    "SLACE139_Be_D": [{"A": 9, "Z": 4}, {"A": 2, "Z": 1}],
    "SLACE139_Ca_D": [{"A": 40, "Z": 20}, {"A": 2, "Z": 1}],
    "SLACE139_C_D": [{"A": 12, "Z": 6}, {"A": 2, "Z": 1}],
    "SLACE139_Fe_D": [{"A": 56, "Z": 26}, {"A": 2, "Z": 1}],
    "SLACE139_He_D": [{"A": 4, "Z": 2}, {"A": 2, "Z": 1}],
    "EMC88_Cu_D": [{"A": 64, "Z": 29}, {"A": 2, "Z": 1}],
    "EMC97_Fe_D": [{"A": 56, "Z": 26}, {"A": 2, "Z": 1}],
    "EMC88_Sn_D": [{"A": 119, "Z": 50}, {"A": 2, "Z": 1}],
    "EMC90_C_D": [{"A": 12, "Z": 6}, {"A": 2, "Z": 1}],
    "BCDMS85_Fe_D": [{"A": 56, "Z": 26}, {"A": 2, "Z": 1}],
    "BCDMS85_N_D": [{"A": 14, "Z": 7}, {"A": 2, "Z": 1}],
    "FNALE665_C_D": [{"A": 12, "Z": 6}, {"A": 2, "Z": 1}],
    "FNALE665_Pb_D": [{"A": 208, "Z": 82}, {"A": 2, "Z": 1}],
    "FNALE665_Xe_D": [{"A": 131, "Z": 54}, {"A": 2, "Z": 1}],
    "SLAC_D": [{"A": 2, "Z": 1}],
    "BCDMS_D": [{"A": 2, "Z": 1}],
    "NTVNBDMN_FE": [{"A": 56, "Z": 26}],
    "NTVNUDMN_FE": [{"A": 56, "Z": 26}],
    "CHORUSNU_PB": [{"A": 208, "Z": 82}],
    "CHORUSNB_PB": [{"A": 208, "Z": 82}],
    "POSF2U_A2": [{"A": 2, "Z": 1}],
    "POSF2U_A4": [{"A": 4, "Z": 2}],
    "POSF2U_A6": [{"A": 6, "Z": 3}],
    "POSF2U_A9": [{"A": 9, "Z": 4}],
    "POSF2U_A12": [{"A": 12, "Z": 6}],
    "POSF2U_A14": [{"A": 14, "Z": 7}],
    "POSF2U_A27": [{"A": 27, "Z": 13}],
    "POSF2U_A40": [{"A": 40, "Z": 20}],
    "POSF2U_A56": [{"A": 56, "Z": 26}],
    "POSF2U_A64": [{"A": 64, "Z": 29}],
    "POSF2U_A108": [{"A": 108, "Z": 82}],
    "POSF2U_A119": [{"A": 119, "Z": 50}],
    "POSF2U_A131": [{"A": 131, "Z": 54}],
    "POSF2U_A197": [{"A": 197, "Z": 79}],
    "POSF2U_A208": [{"A": 208, "Z": 82}],
    "POSF2DW_A2": [{"A": 2, "Z": 1}],
    "POSF2DW_A4": [{"A": 4, "Z": 2}],
    "POSF2DW_A6": [{"A": 6, "Z": 3}],
    "POSF2DW_A9": [{"A": 9, "Z": 4}],
    "POSF2DW_A12": [{"A": 12, "Z": 6}],
    "POSF2DW_A14": [{"A": 14, "Z": 7}],
    "POSF2DW_A27": [{"A": 27, "Z": 13}],
    "POSF2DW_A40": [{"A": 40, "Z": 20}],
    "POSF2DW_A56": [{"A": 56, "Z": 26}],
    "POSF2DW_A64": [{"A": 64, "Z": 29}],
    "POSF2DW_A108": [{"A": 108, "Z": 82}],
    "POSF2DW_A119": [{"A": 119, "Z": 50}],
    "POSF2DW_A131": [{"A": 131, "Z": 54}],
    "POSF2DW_A197": [{"A": 197, "Z": 79}],
    "POSF2DW_A208": [{"A": 208, "Z": 82}],
    "POSF2S_A2": [{"A": 2, "Z": 1}],
    "POSF2S_A4": [{"A": 4, "Z": 2}],
    "POSF2S_A6": [{"A": 6, "Z": 3}],
    "POSF2S_A9": [{"A": 9, "Z": 4}],
    "POSF2S_A12": [{"A": 12, "Z": 6}],
    "POSF2S_A14": [{"A": 14, "Z": 7}],
    "POSF2S_A27": [{"A": 27, "Z": 13}],
    "POSF2S_A40": [{"A": 40, "Z": 20}],
    "POSF2S_A56": [{"A": 56, "Z": 26}],
    "POSF2S_A64": [{"A": 64, "Z": 29}],
    "POSF2S_A108": [{"A": 108, "Z": 82}],
    "POSF2S_A119": [{"A": 119, "Z": 50}],
    "POSF2S_A131": [{"A": 131, "Z": 54}],
    "POSF2S_A197": [{"A": 197, "Z": 79}],
    "POSF2S_A208": [{"A": 208, "Z": 82}],
    "POSFLL_A2": [{"A": 2, "Z": 1}],
    "POSFLL_A4": [{"A": 4, "Z": 2}],
    "POSFLL_A6": [{"A": 6, "Z": 3}],
    "POSFLL_A9": [{"A": 9, "Z": 4}],
    "POSFLL_A12": [{"A": 12, "Z": 6}],
    "POSFLL_A14": [{"A": 14, "Z": 7}],
    "POSFLL_A27": [{"A": 27, "Z": 13}],
    "POSFLL_A40": [{"A": 40, "Z": 20}],
    "POSFLL_A56": [{"A": 56, "Z": 26}],
    "POSFLL_A64": [{"A": 64, "Z": 29}],
    "POSFLL_A108": [{"A": 108, "Z": 82}],
    "POSFLL_A119": [{"A": 119, "Z": 50}],
    "POSFLL_A131": [{"A": 131, "Z": 54}],
    "POSFLL_A197": [{"A": 197, "Z": 79}],
    "POSFLL_A208": [{"A": 208, "Z": 82}],
    "POSDYU_A2": [{"A": 2, "Z": 1}],
    "POSDYU_A4": [{"A": 4, "Z": 2}],
    "POSDYU_A6": [{"A": 6, "Z": 3}],
    "POSDYU_A9": [{"A": 9, "Z": 4}],
    "POSDYU_A12": [{"A": 12, "Z": 6}],
    "POSDYU_A14": [{"A": 14, "Z": 7}],
    "POSDYU_A27": [{"A": 27, "Z": 13}],
    "POSDYU_A40": [{"A": 40, "Z": 20}],
    "POSDYU_A56": [{"A": 56, "Z": 26}],
    "POSDYU_A64": [{"A": 64, "Z": 29}],
    "POSDYU_A108": [{"A": 108, "Z": 82}],
    "POSDYU_A119": [{"A": 119, "Z": 50}],
    "POSDYU_A131": [{"A": 131, "Z": 54}],
    "POSDYU_A197": [{"A": 197, "Z": 79}],
    "POSDYU_A208": [{"A": 208, "Z": 82}],
    "POSDYD_A2": [{"A": 2, "Z": 1}],
    "POSDYD_A4": [{"A": 4, "Z": 2}],
    "POSDYD_A6": [{"A": 6, "Z": 3}],
    "POSDYD_A9": [{"A": 9, "Z": 4}],
    "POSDYD_A12": [{"A": 12, "Z": 6}],
    "POSDYD_A14": [{"A": 14, "Z": 7}],
    "POSDYD_A27": [{"A": 27, "Z": 13}],
    "POSDYD_A40": [{"A": 40, "Z": 20}],
    "POSDYD_A56": [{"A": 56, "Z": 26}],
    "POSDYD_A64": [{"A": 64, "Z": 29}],
    "POSDYD_A108": [{"A": 108, "Z": 82}],
    "POSDYD_A119": [{"A": 119, "Z": 50}],
    "POSDYD_A131": [{"A": 131, "Z": 54}],
    "POSDYD_A197": [{"A": 197, "Z": 79}],
    "POSDYD_A208": [{"A": 208, "Z": 82}],
    "POSDYS_A2": [{"A": 2, "Z": 1}],
    "POSDYS_A4": [{"A": 4, "Z": 2}],
    "POSDYS_A6": [{"A": 6, "Z": 3}],
    "POSDYS_A9": [{"A": 9, "Z": 4}],
    "POSDYS_A12": [{"A": 12, "Z": 6}],
    "POSDYS_A14": [{"A": 14, "Z": 7}],
    "POSDYS_A27": [{"A": 27, "Z": 13}],
    "POSDYS_A40": [{"A": 40, "Z": 20}],
    "POSDYS_A56": [{"A": 56, "Z": 26}],
    "POSDYS_A64": [{"A": 64, "Z": 29}],
    "POSDYS_A108": [{"A": 108, "Z": 82}],
    "POSDYS_A119": [{"A": 119, "Z": 50}],
    "POSDYS_A131": [{"A": 131, "Z": 54}],
    "POSDYS_A197": [{"A": 197, "Z": 79}],
    "POSDYS_A208": [{"A": 208, "Z": 82}],
    "POSF2C_A2": [{"A": 2, "Z": 1}],
    "POSF2C_A4": [{"A": 4, "Z": 2}],
    "POSF2C_A6": [{"A": 6, "Z": 3}],
    "POSF2C_A9": [{"A": 9, "Z": 4}],
    "POSF2C_A12": [{"A": 12, "Z": 6}],
    "POSF2C_A14": [{"A": 14, "Z": 7}],
    "POSF2C_A27": [{"A": 27, "Z": 13}],
    "POSF2C_A40": [{"A": 40, "Z": 20}],
    "POSF2C_A56": [{"A": 56, "Z": 26}],
    "POSF2C_A64": [{"A": 64, "Z": 29}],
    "POSF2C_A108": [{"A": 108, "Z": 82}],
    "POSF2C_A119": [{"A": 119, "Z": 50}],
    "POSF2C_A131": [{"A": 131, "Z": 54}],
    "POSF2C_A197": [{"A": 197, "Z": 79}],
    "POSF2C_A208": [{"A": 208, "Z": 82}],
    "POSXUQ_A2": [{"A": 2, "Z": 1}],
    "POSXUQ_A4": [{"A": 4, "Z": 2}],
    "POSXUQ_A6": [{"A": 6, "Z": 3}],
    "POSXUQ_A9": [{"A": 9, "Z": 4}],
    "POSXUQ_A12": [{"A": 12, "Z": 6}],
    "POSXUQ_A14": [{"A": 14, "Z": 7}],
    "POSXUQ_A27": [{"A": 27, "Z": 13}],
    "POSXUQ_A40": [{"A": 40, "Z": 20}],
    "POSXUQ_A56": [{"A": 56, "Z": 26}],
    "POSXUQ_A64": [{"A": 64, "Z": 29}],
    "POSXUQ_A108": [{"A": 108, "Z": 82}],
    "POSXUQ_A119": [{"A": 119, "Z": 50}],
    "POSXUQ_A131": [{"A": 131, "Z": 54}],
    "POSXUQ_A197": [{"A": 197, "Z": 79}],
    "POSXUQ_A208": [{"A": 208, "Z": 82}],
    "POSXUB_A2": [{"A": 2, "Z": 1}],
    "POSXUB_A4": [{"A": 4, "Z": 2}],
    "POSXUB_A6": [{"A": 6, "Z": 3}],
    "POSXUB_A9": [{"A": 9, "Z": 4}],
    "POSXUB_A12": [{"A": 12, "Z": 6}],
    "POSXUB_A14": [{"A": 14, "Z": 7}],
    "POSXUB_A27": [{"A": 27, "Z": 13}],
    "POSXUB_A40": [{"A": 40, "Z": 20}],
    "POSXUB_A56": [{"A": 56, "Z": 26}],
    "POSXUB_A64": [{"A": 64, "Z": 29}],
    "POSXUB_A108": [{"A": 108, "Z": 82}],
    "POSXUB_A119": [{"A": 119, "Z": 50}],
    "POSXUB_A131": [{"A": 131, "Z": 54}],
    "POSXUB_A197": [{"A": 197, "Z": 79}],
    "POSXUB_A208": [{"A": 208, "Z": 82}],
    "POSXDQ_A2": [{"A": 2, "Z": 1}],
    "POSXDQ_A4": [{"A": 4, "Z": 2}],
    "POSXDQ_A6": [{"A": 6, "Z": 3}],
    "POSXDQ_A9": [{"A": 9, "Z": 4}],
    "POSXDQ_A12": [{"A": 12, "Z": 6}],
    "POSXDQ_A14": [{"A": 14, "Z": 7}],
    "POSXDQ_A27": [{"A": 27, "Z": 13}],
    "POSXDQ_A40": [{"A": 40, "Z": 20}],
    "POSXDQ_A56": [{"A": 56, "Z": 26}],
    "POSXDQ_A64": [{"A": 64, "Z": 29}],
    "POSXDQ_A108": [{"A": 108, "Z": 82}],
    "POSXDQ_A119": [{"A": 119, "Z": 50}],
    "POSXDQ_A131": [{"A": 131, "Z": 54}],
    "POSXDQ_A197": [{"A": 197, "Z": 79}],
    "POSXDQ_A208": [{"A": 208, "Z": 82}],
    "POSXDB_A2": [{"A": 2, "Z": 1}],
    "POSXDB_A4": [{"A": 4, "Z": 2}],
    "POSXDB_A6": [{"A": 6, "Z": 3}],
    "POSXDB_A9": [{"A": 9, "Z": 4}],
    "POSXDB_A12": [{"A": 12, "Z": 6}],
    "POSXDB_A14": [{"A": 14, "Z": 7}],
    "POSXDB_A27": [{"A": 27, "Z": 13}],
    "POSXDB_A40": [{"A": 40, "Z": 20}],
    "POSXDB_A56": [{"A": 56, "Z": 26}],
    "POSXDB_A64": [{"A": 64, "Z": 29}],
    "POSXDB_A108": [{"A": 108, "Z": 82}],
    "POSXDB_A119": [{"A": 119, "Z": 50}],
    "POSXDB_A131": [{"A": 131, "Z": 54}],
    "POSXDB_A197": [{"A": 197, "Z": 79}],
    "POSXDB_A208": [{"A": 208, "Z": 82}],
    "POSXSQ_A2": [{"A": 2, "Z": 1}],
    "POSXSQ_A4": [{"A": 4, "Z": 2}],
    "POSXSQ_A6": [{"A": 6, "Z": 3}],
    "POSXSQ_A9": [{"A": 9, "Z": 4}],
    "POSXSQ_A12": [{"A": 12, "Z": 6}],
    "POSXSQ_A14": [{"A": 14, "Z": 7}],
    "POSXSQ_A27": [{"A": 27, "Z": 13}],
    "POSXSQ_A40": [{"A": 40, "Z": 20}],
    "POSXSQ_A56": [{"A": 56, "Z": 26}],
    "POSXSQ_A64": [{"A": 64, "Z": 29}],
    "POSXSQ_A108": [{"A": 108, "Z": 82}],
    "POSXSQ_A119": [{"A": 119, "Z": 50}],
    "POSXSQ_A131": [{"A": 131, "Z": 54}],
    "POSXSQ_A197": [{"A": 197, "Z": 79}],
    "POSXSQ_A208": [{"A": 208, "Z": 82}],
    "POSXSB_A2": [{"A": 2, "Z": 1}],
    "POSXSB_A4": [{"A": 4, "Z": 2}],
    "POSXSB_A6": [{"A": 6, "Z": 3}],
    "POSXSB_A9": [{"A": 9, "Z": 4}],
    "POSXSB_A12": [{"A": 12, "Z": 6}],
    "POSXSB_A14": [{"A": 14, "Z": 7}],
    "POSXSB_A27": [{"A": 27, "Z": 13}],
    "POSXSB_A40": [{"A": 40, "Z": 20}],
    "POSXSB_A56": [{"A": 56, "Z": 26}],
    "POSXSB_A64": [{"A": 64, "Z": 29}],
    "POSXSB_A108": [{"A": 108, "Z": 82}],
    "POSXSB_A119": [{"A": 119, "Z": 50}],
    "POSXSB_A131": [{"A": 131, "Z": 54}],
    "POSXSB_A197": [{"A": 197, "Z": 79}],
    "POSXSB_A208": [{"A": 208, "Z": 82}],
    "POSXGL_A2": [{"A": 2, "Z": 1}],
    "POSXGL_A4": [{"A": 4, "Z": 2}],
    "POSXGL_A6": [{"A": 6, "Z": 3}],
    "POSXGL_A9": [{"A": 9, "Z": 4}],
    "POSXGL_A12": [{"A": 12, "Z": 6}],
    "POSXGL_A14": [{"A": 14, "Z": 7}],
    "POSXGL_A27": [{"A": 27, "Z": 13}],
    "POSXGL_A40": [{"A": 40, "Z": 20}],
    "POSXGL_A56": [{"A": 56, "Z": 26}],
    "POSXGL_A64": [{"A": 64, "Z": 29}],
    "POSXGL_A108": [{"A": 108, "Z": 82}],
    "POSXGL_A119": [{"A": 119, "Z": 50}],
    "POSXGL_A131": [{"A": 131, "Z": 54}],
    "POSXGL_A197": [{"A": 197, "Z": 79}],
    "POSXGL_A208": [{"A": 208, "Z": 82}],
    "INTEGXT8_A2": [{"A": 2, "Z": 1}],
    "INTEGXT8_A4": [{"A": 4, "Z": 2}],
    "INTEGXT8_A6": [{"A": 6, "Z": 3}],
    "INTEGXT8_A9": [{"A": 9, "Z": 4}],
    "INTEGXT8_A12": [{"A": 12, "Z": 6}],
    "INTEGXT8_A14": [{"A": 14, "Z": 7}],
    "INTEGXT8_A27": [{"A": 27, "Z": 13}],
    "INTEGXT8_A40": [{"A": 40, "Z": 20}],
    "INTEGXT8_A56": [{"A": 56, "Z": 26}],
    "INTEGXT8_A64": [{"A": 64, "Z": 29}],
    "INTEGXT8_A108": [{"A": 108, "Z": 82}],
    "INTEGXT8_A119": [{"A": 119, "Z": 50}],
    "INTEGXT8_A131": [{"A": 131, "Z": 54}],
    "INTEGXT8_A197": [{"A": 197, "Z": 79}],
    "INTEGXT8_A208": [{"A": 208, "Z": 82}],
    "INTEGXT3_A2": [{"A": 2, "Z": 1}],
    "INTEGXT3_A4": [{"A": 4, "Z": 2}],
    "INTEGXT3_A6": [{"A": 6, "Z": 3}],
    "INTEGXT3_A9": [{"A": 9, "Z": 4}],
    "INTEGXT3_A12": [{"A": 12, "Z": 6}],
    "INTEGXT3_A14": [{"A": 14, "Z": 7}],
    "INTEGXT3_A27": [{"A": 27, "Z": 13}],
    "INTEGXT3_A40": [{"A": 40, "Z": 20}],
    "INTEGXT3_A56": [{"A": 56, "Z": 26}],
    "INTEGXT3_A64": [{"A": 64, "Z": 29}],
    "INTEGXT3_A108": [{"A": 108, "Z": 82}],
    "INTEGXT3_A119": [{"A": 119, "Z": 50}],
    "INTEGXT3_A131": [{"A": 131, "Z": 54}],
    "INTEGXT3_A197": [{"A": 197, "Z": 79}],
    "INTEGXT3_A208": [{"A": 208, "Z": 82}],
}


def add_nucinfo(name: str, n_fktables: int) -> list:
    """Given a dataset name returns the corresponding `A` and `Z` values.

    This is done by checking first if the dataset name appears first in
    the nuclear list above, `NDATA_SPECS`. If not, return the proton
    values that has the same length as the FK tables.

    Parameters
    ----------
    name: str
        name of the current dataset
    n_fktables: int
        number of the required FK tables corresponding required by the
        dataset

    Returns
    -------
    add_nucinfo: list
        list containing the `A` and `Z` values

    """
    if name in NDATA_SPECS.keys():
        return NDATA_SPECS[name]
    else:
        return [{"A": 1, "Z": 1}] * n_fktables
